default_platform(:ios)

platform :ios do
  desc "æ‰¹é‡åˆ›å»º App IDï¼ˆBundle IDï¼‰"
  lane :create_bundle_ids do
    require 'csv'

    # è¯»å– CSV å¹¶æ‰¹é‡åˆ›å»º Bundle ID
    prefix = "com.getsticker.stickerpack"

    CSV.foreach(File.expand_path("../apps_config/apps.csv", __dir__), headers: true) do |row|
      short_id = row["short_id"]
      app_name = row["app_name"]
      bundle_id = "#{prefix}.#{short_id}"

      UI.message("ğŸ“± æ­£åœ¨åˆ›å»º App ID: #{bundle_id} (#{app_name})")

      begin
        create_app_identifier(
          bundle_id: bundle_id,
          app_name: app_name
        )
        UI.success("âœ… æˆåŠŸåˆ›å»º #{bundle_id}")
      rescue => e
        UI.error("âŒ åˆ›å»ºå¤±è´¥ #{bundle_id} - #{e.message}")
      end
    end
  end
end